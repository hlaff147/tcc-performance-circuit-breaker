\section{Results and Discussion}
\label{sec:results}

Load tests were executed using k6 and Docker Compose. Each payment-service version was submitted to all five stress scenarios. Results were evaluated against defined thresholds and analyzed in terms of success rate, response time, and fallback contribution.

\subsection{Consolidated Results Overview}

Table~\ref{tab:consolidated} presents the consolidated comparison between V1 (Baseline) and V2 (Circuit Breaker).

\begin{table}[!t]
\centering
\caption{Consolidated Comparison: V1 vs V2 by Scenario}
\label{tab:consolidated}
\small
\begin{tabular}{lcccc}
\toprule
Scenario & V1 & V2 & Fallback & Fail. Red. \\
\midrule
Catastrophe & 35.7\% & \textbf{95.1\%} & 62.1\% & -92.3\% \\
Degradation & 75.4\% & \textbf{95.4\%} & 64.7\% & -81.4\% \\
Unavail. & 10.5\% & \textbf{99.6\%} & 99.1\% & -99.5\% \\
Normal & 100.0\% & 100.0\% & 0.0\% & 0.0\% \\
Bursts & 63.0\% & \textbf{96.7\%} & 34.6\% & -91.0\% \\
\bottomrule
\end{tabular}
\end{table}

\textbf{Key Findings:}
\begin{itemize}
    \item V2 demonstrated gains of \textbf{+20pp to +89pp} in success rate across all failure scenarios;
    \item In Extreme Unavailability, V2 transformed a system with only 10.5\% success into one with 99.6\%â€”a \textbf{9.5x improvement};
    \item The fallback mechanism (HTTP 202) accounted for up to 99.1\% of successful responses in worst scenarios;
    \item In Normal scenario, no difference between versions confirms CB introduces \textbf{no overhead} in healthy conditions.
\end{itemize}

\subsection{V3 (Retry) Analysis}

Table~\ref{tab:v3comparison} includes V3 (Retry with exponential backoff) for comparison.

\begin{table}[!t]
\centering
\caption{Detailed Comparison: V1 vs V2 vs V3}
\label{tab:v3comparison}
\small
\begin{tabular}{lrrr}
\toprule
Scenario & V1 & V2 (CB) & V3 (Retry) \\
\midrule
Catastrophe & 35.7\% & \textbf{95.1\%} & 52.8\% \\
Degradation & 75.4\% & \textbf{95.4\%} & 76.4\% \\
Unavail. & 10.5\% & \textbf{99.6\%} & 15.7\% \\
Normal & 100.0\% & 100.0\% & 100.0\% \\
Bursts & 63.0\% & \textbf{96.7\%} & 77.7\% \\
\bottomrule
\end{tabular}
\end{table}

\vspace{1em}

\textbf{Critical Observations on Retry:}
\begin{enumerate}
    \item Retry does NOT improve availability in persistent failures;
    \item Retry increases latency due to retry attempts;
    \item Retry can amplify problems by tripling load on overloaded services.
\end{enumerate}

\subsection{Statistical Analysis}

Table~\ref{tab:statistics} presents formal statistical validation.

\begin{table}[!t]
\centering
\caption{Statistical Analysis: V1 vs V2}
\label{tab:statistics}
\small
\begin{tabular}{lr}
\toprule
Metric & Value \\
\midrule
t-test (p-value) & p $<$ 0.0001 \\
Cohen's d & 1.078 (\textbf{large}) \\
\midrule
ANOVA F-statistic & 546.79 (p $<$ 0.0001) \\
Eta-squared ($\eta^2$) & 0.267 (large) \\
\midrule
95\% CI (V1) & [495.86; 508.01] ms \\
95\% CI (V2) & [400.72; 410.62] ms \\
95\% CI (V3) & [543.38; 558.02] ms \\
\bottomrule
\end{tabular}
\end{table}

\vspace{0.5em}

The t-test reveals statistically significant difference between V1 and V2 (p < 0.0001). Cohen's d (d = 1.078) classifies the effect size as \textbf{large}, confirming substantial practical relevance. ANOVA confirmed significant difference among all three groups (F = 546.79, p < 0.0001).

\subsection{Quantified Impact}

The Circuit Breaker provided significant gains across all failure scenarios:
\begin{itemize}
    \item \textbf{Catastrophe:} +59.3pp (35.7\% $\rightarrow$ 95.1\%)
    \item \textbf{Degradation:} +20.0pp (75.4\% $\rightarrow$ 95.4\%)
    \item \textbf{Unavailability:} +89.1pp (10.5\% $\rightarrow$ 99.6\%)
    \item \textbf{Bursts:} +33.6pp (63.0\% $\rightarrow$ 96.7\%)
\end{itemize}

\subsection{Detailed Analysis: Bursts and Catastrophe}

Scenarios of \textbf{Intermittent Bursts} and \textbf{Catastrophic Failure} deserve special attention as they demonstrate the most significant Circuit Breaker benefits. Figure~\ref{fig:v1v2comparison} shows the direct comparison.

\begin{figure}[H]
\centering
\includegraphics[width=0.45\textwidth]{images/01_v1_v2_success_rate_comparison.png}
\caption{Success Rate Comparison: V1 vs V2 in Bursts and Catastrophe}
\label{fig:v1v2comparison}
\end{figure}

\textbf{Key Findings:}
\begin{itemize}
    \item In \textbf{Bursts}, V1 achieved only 63.0\% success while V2 reached \textbf{96.7\%}, a gain of \textbf{+33.6pp}.
    \item In \textbf{Catastrophe}, V1 registered 35.7\% success (system nearly unusable) while V2 maintained \textbf{95.1\%}, a gain of \textbf{+59.3pp}.
    \item Failure reduction exceeded \textbf{91\%} in both scenarios.
\end{itemize}

The Circuit Breaker achieves these results by transforming HTTP 500 errors into HTTP 202 (fallback) responses. In the Catastrophe scenario, 62.1\% of V2 responses came from fallback, effectively converting fatal errors into meaningful responses for end users.

\begin{figure}[H]
\centering
\includegraphics[width=0.48\textwidth]{images/05_combined_summary.png}
\caption{Consolidated Impact Analysis: Bursts and Catastrophe}
\label{fig:consolidated}
\end{figure}

These results validate three fundamental characteristics:
(1) \textbf{Fail-Fast with Graceful Degradation} --- the system returns meaningful alternative responses immediately;
(2) \textbf{Elasticity} --- the CB transitions dynamically between states based on dependency health;
(3) \textbf{Resource Protection} --- threads are released immediately during failures, preventing thread pool starvation.

\textbf{Sliding Window Detection Mechanism:}
A notable aspect is the CB's ability to ``anticipate'' failures through its sliding window mechanism. The CB monitors the last 10 requests and opens when failure rate exceeds 50\%. In the Catastrophe scenario, fallback rate (62.1\%) closely matched V1's actual failure rate (64.3\%), yielding a \textbf{96.6\% coverage ratio}. In Bursts, the CB demonstrated elasticity by transitioning states dynamically: fallback rate (34.6\%) matched V1 failures (37.0\%) with 93.5\% coverage, while maintaining direct success rate (62.0\%) nearly identical to V1 (63.0\%). This indicates the CB did not block requests unnecessarily during healthy periods, but correctly activated fallback during actual failures --- achieving intelligent fail-fast behavior through the half-open state mechanism that periodically probes dependency health.
